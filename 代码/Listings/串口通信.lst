C51 COMPILER V9.55   ________                                                              12/11/2016 13:57:33 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE ________
OBJECT MODULE PLACED IN .\Objects\╢╝©зм╗пе.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Keil\C51\BIN\C51.EXE ╢╝©зм╗пе.c OPTIMIZE(8,SPEED) BROWSE INCDIR(C:\Program F
                    -iles (x86)\Keil\C51\INC) DEBUG OBJECTEXTEND PRINT(.\Listings\╢╝©зм╗пе.lst) OBJECT(.\Objects\╢╝©зм╗пе.obj)

line level    source

   1          #include <reg52.h>
   2          #define uchar unsigned char
   3          void init_com(){
   4   1              SCON=0X50;                      //Х╝╬Г╫╝Д╦╡Е▐ёГ └Е╥╔Д╫°Ф√╧Е╪▐Д╦╨1
   5   1              TMOD=0X20;                      //Х╝╬Г╫╝Х╝║Ф∙╟Е≥╗Е╥╔Д╫°Ф√╧Е╪▐Д╦╨2
   6   1              TH1=0Xfd;                   //Х╝║Ф∙╟Е≥╗Е┬²Е╖▀Е─╪Х╝╬Г╫╝О╪▄ФЁ╒Г┴╧Г▌┤Ф≤╞9600
   7   1              TL1=0Xfd;
   8   1              TR1=1;                                      //Ф┴⌠Е╪─Х╝║Ф∙╟Е≥╗
   9   1              ES=1;        //Ф┴⌠Е╪─Ф▌╔Ф■╤Д╦╜Ф√╜
  10   1          EA=1;        //Ф┴⌠Е╪─Ф─╩Д╦╜Ф√╜
  11   1      }
  12          
  13          
  14          void send_data(uchar *str){
  15   1              uchar i;
  16   1              for(i=0;str[i]!='\0';i++){
  17   2                      SBUF = str[i];
  18   2                      while(!TI);
  19   2                      TI = 0;
  20   2              }
  21   1      }
  22          
  23          void delay_ms(uchar ms)                          //Е╩╤Ф≈╤Г╗▀Е╨▐,Е╩╤Ф≈╤Г╨╕msФ╞╚Г╖▓
  24          {    
  25   1              uchar i,j;
  26   1              while(ms--)
  27   1                      for(i = 0 ;i<5; i++)
  28   1                              for(j=0;j<220;j++);
  29   1      }
  30          
  31          
  32          
  33          sbit DS = P2^5;                            //Е╟├Е█∙Г┴┤Ф°╨Г └P2.5Е╪∙Х└ Е╝ Д╧┴Д╦╨74HC595Г └Д╦╡Х║▄Ф∙╟Ф█╝Х╬⌠Е┘
             -╔Г╚╞
  34          sbit STCP = P2^6;                          //Е╟├Е█∙Г┴┤Ф°╨Г └P2.6Е╪∙Х└ Е╝ Д╧┴Д╦╨74HC595Г └Е╜≤Е┌╗Е╞└Е╜≤Е≥╗Ф≈
             -╤И▓÷Х╬⌠Е┘╔Г╚╞
  35          sbit SHCP = P2^7;                          //Е╟├Е█∙Г┴┤Ф°╨Г └P2.7Е╪∙Х└ Е╝ Д╧┴Д╦╨74HC595Г └Г╖╩Д╫█Е╞└Е╜≤Е≥╗Ф≈
             -╤И▓÷Х╬⌠Е┘╔Г╚╞
  36          
  37          sbit wx1=P0^4;                                            //Д╫█И─┴0О╪▄Д╫▌Г■╣Е╧ЁФ°┴Ф∙┬О╪▄И─┴Д╦╜Г╛╛Д╦─Д╦╙Ф∙╟
             -Г═│Г╝║
  38          sbit wx2=P0^5;                                            //Д╫█И─┴1О╪▄Д╫▌Г■╣Е╧ЁФ°┴Ф∙┬О╪▄И─┴Д╦╜Г╛╛Д╨▄Д╦╙Ф∙╟
             -Г═│Г╝║
  39          sbit wx3=P0^6;                                            //Д╫█И─┴2О╪▄Д╫▌Г■╣Е╧ЁФ°┴Ф∙┬О╪▄И─┴Д╦╜Г╛╛Д╦┴Д╦╙Ф∙╟
             -Г═│Г╝║
  40          sbit wx4=P0^7;                                            //Д╫█И─┴3О╪▄Д╫▌Г■╣Е╧ЁФ°┴Ф∙┬О╪▄И─┴Д╦╜Г╛╛Е⌡⌡Д╦╙Ф∙╟
             -Г═│Г╝║
  41          /*Е┘╠И≤╢Ф·│Ф∙╟Г═│Г╝║Ф≤╬Г╓╨0~9Ф≈╤Г └Х╬⌠Е┘╔Ф∙╟Ф█╝*/
  42          uchar table[] = {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
  43          /*Ф∙╟Г═│Г╝║Ф≤╬Г╓╨Е┤╫Ф∙╟О╪▄Е┬╘Г■╗74HC595Е╝·Г▌╟Д╦╡Х║▄Х╬⌠Е┘╔Е╧╤Х║▄Х╬⌠Е┤╨*/
  44          
  45          uchar display_data[4];
  46          uchar received_data[4];
  47          uchar cnt=0;
C51 COMPILER V9.55   ________                                                              12/11/2016 13:57:33 PAGE 2   

  48          void ser_inout(uchar datas){
  49   1              uchar i;
  50   1              STCP = 0;                                     
  51   1              for(i=0 ; i < 8 ; i++)                   //Д╩▌И╚≤Д╫█Е┬╟Д╫▌Д╫█О╪▄Д╬²Ф╛║Д╪═И─│Ф∙╟Ф█╝
  52   1              {
  53   2                      SHCP = 0;                              
  54   2                      DS=datas & 0x80;                
  55   2                      datas<<=1;                            
  56   2                      SHCP = 1;                              //P2.7Е╪∙Х└ Г╫╝1О╪▄Д╨╖Г■÷Д╦┼Е█┤Ф╡©О╪▄Е╟├P2.5Е╪∙Х└ Д╦┼Г └Ф∙╟Ф█╝Д╪═
             -Е┘╔74HC595
  57   2              }
  58   1              STCP = 1;                                //P2.6Г╫╝1О╪▄Д╨╖Г■÷Д╦┼Е█┤Ф╡©
  59   1      }
  60          
  61          
  62          void display(){
  63   1              while(1){//Д╦─Г⌡╢Е┬╥Ф√╟Ф≤╬Г╓╨
  64   2                      wx1=0;
  65   2                      ser_inout(display_data[0]);
  66   2                      delay_ms(1);
  67   2                      wx1=1;
  68   2                      
  69   2                      wx2=0;
  70   2                      ser_inout(display_data[1]);
  71   2                      delay_ms(1);
  72   2                      wx2=1;
  73   2                      
  74   2                      wx3=0;
  75   2                      ser_inout(display_data[2]);
  76   2                      delay_ms(1);
  77   2                      wx3=1;
  78   2                      
  79   2                      wx4=0;
  80   2                      ser_inout(display_data[3]);
  81   2                      delay_ms(1);
  82   2                      wx4=1;
  83   2              }
  84   1      }
  85          
  86          void update_display() interrupt 4{
  87   1              uchar i;
  88   1              //Ф▌╔Ф■╤Ф∙╟Ф█╝
  89   1              if(RI==1){
  90   2                      received_data[cnt%4]=SBUF;
  91   2                      cnt++;
  92   2                      RI=0;
  93   2              }
  94   1              //Ф≤╬Г╓╨Ф∙╟Ф█╝
  95   1              if(cnt%4==0){
  96   2                      for(i=0;i<4;i++) display_data[i]=table[received_data[i]-'0'];
  97   2              }
  98   1      }
  99          
 100          int main(){
 101   1          init_com();//Е┬²Е╖▀Е▄√Д╦╡Х║▄Е▐ёХ╝╬Г╫╝
 102   1              send_data("Hello World!");
 103   1              display();//Д╦─Г⌡╢Ф≤╬Г╓╨Е╧╤Г╜┴Е╬┘Д╦╜Ф√╜Ф⌡╢Ф√╟Ф≤╬Г╓╨
 104   1              return 0;
 105   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.55   ________                                                              12/11/2016 13:57:33 PAGE 3   

   CODE SIZE        =    230    ----
   CONSTANT SIZE    =     13    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     19       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
